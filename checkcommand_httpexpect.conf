
object CheckCommand "http_expect" {
  command = [ PluginContribDir + "/check_http_expect" ]
  
  arguments = {
    "--url" = {
      value = "$http_expect_url$" // The service parameter would then be defined as 'vars.http_expect_url = "narf.zort"'
      description = "URL of the page to be checked"
      required = true
    }
    "--find" = {
      value = "$http_expect_find$"
      description = "Text or RegEx to search for"
      required = false
    }
    "--find-from-file" = {
      value = "$http_expect_find_from_file$"
      description = "Textfile with content to search for"
      required = false
    }
    "--find-no-regex" = {
      value = "$http_expect_find_no_regex$"
      description = "Text to search for (interpreted as fixed strings, not RegEx)"
      required = false
    }
    "--find-from-file-no-regex" = {
      value = "$http_expect_find_from_file_no_regex$"
      description = "Textfile with content to search for (interpreted as fixed strings, not RegEx)"
      required = false
    }
    "--avoid" = {
      value = "$http_expect_avoid$"
      description = "Text or RegEx that shall not occur"
      required = false
    }
    "--find-header" = {
      value = "$http_expect_find_header$"
      description = "Text or RegEx to search for in the headers"
      required = false
    }
    "--avoid-header" = {
      value = "$http_expect_avoid_header$"
      description = "Text or RegEx that shall not occur in the headers"
      required = false
    }
    "--follow" = {
      set_if = "$http_expect_follow$"
      description = "follow redirects"
      required = false
    }
    "--ua" = {
      value = "$http_expect_useragent$"
      description = "custom user-agent"
      required = false
    }
  }
}
